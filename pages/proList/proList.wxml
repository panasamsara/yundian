<!--orderdetail.wxml-->
<view class="">


  <!--底部商品-->
  <view class="goods" style="height: {{goodsH}}rpx;">
    <!--左侧产品列表-->
    <view class="menu-wrapper" style="height: {{goodsH}}px;">
    <scroll-view scroll-y style="height: {{goodsH}}px;"   scroll-with-animation="{{animation}}">
      <view wx:for="{{shopCategory}}" id="cat_{{index}}_{{item.categoryId}}" class="menu-item {{(catHighLightIndex == index) ? 'current':''}}" bindtap="catClickFn">{{item.categoryName}}</view>
      </scroll-view>
    </view>

    <!--右侧产品列表-->
    <view class="foods-wrapper" style="height: {{goodsH}}px;">
      <scroll-view scroll-y style="height: 100%;" scroll-into-view="{{toView}}">
      <view  class="food-grouping" id="catGood_{{item.id}}">
        <view wx:for="{{goodsInCategory}}" wx:for-item="good" class="foods-item" id="{{good.id}}">
          <image  class="icon" src="{{good.pictureUrl}}"></image>
          <view   class="content"><text class="title">{{good.goodsName}}</text><text class="price">¥{{good.price}}</text></view>
          <!--加减器-->
          <view class="cartcontrol-wrap">
            <view class="cartcontrol">
                <!-- <block wx:for="{{shoppingCartGoodsId}}" wx:for-item="goodId">
                  <view bindtap="decreaseGoodToCartFn"  class="cart-decrease {{(good.id == goodId) ? '': 'hidden'}}">
                    <image class="cart-decrease" id="decrease_{{good.id}}" src="./image/fenlei_shanjian@2x.png"></image>
                    <view class="inner icon-remove_circle_outline"></view>
                  </view>
                </block> -->
                <text class="cart-count">{{(shoppingCart[good.id]) ? shoppingCart[good.id]: ""}}</text>
               <image src="./image/fenlei_tianjia@2x.png" bindtap="touchOnGoods" id="add_{{good.id}}" class="cart-add icon-add_circle"></image>
            </view>  
          </view>
        </view>        
      </view>
      </scroll-view>
    </view> 
    
  </view>

  <!--选择商品区域-->
  <view>
    <view class="shopcart">
      <view class="content">
        <view class="content-left" bindtap="showShopCartFn">
           <!-- <view class="logo-wrapper">
            <image class="logo" src="./image/fenlei_gouwuche@2x.png" style="background-image:url(./image/fenlei_gouwuche@2x.png)">
              <i class="icon-shopping_cart"></i>
            </image>
            <view class="num" wx:if="{{totalNum}}">{{totalNum}}</view>
          </view>  -->
          <view class="price {{(totalPay > 0)? 'highlight':''}}">￥{{totalPay}}</view>
        </view>
        <view class="content-right">
          <view bindtap="goToCart" class="pay payClass">去结算<text wx:if='{{totalNum >0}}'>（{{totalNum}}）</text>
          </view>
        </view>
      </view>

      
      <view class="shopcart-list {{(showShopCart && (totalPay > 0))?'':'hidden'}}">
        <!-- <view class="list-header">
          <view class="title"><text class="title-line">已选商品</text> <text class="empty" bindtap="clearShopCartFn">清空</text></view>
        </view> -->
        <scroll-view scroll-y >
        <view class="list-content" >
          
            <view>
              <view class="food" wx:for="{{chooseGoodArr}}" wx:for-item="good">
                <view class="name">{{good.goodsName}}</view>
                <view class="price">
                  <view>￥{{good.price}}</view>
                </view>

                <view class="cartcontrol-wrapper">
                    <view class="cartcontrol">
                        <view bindtap="decreaseGoodToCartFn" data-stockid='{{good.stockId}}' class="cart-decrease">
                            <image id="decrease_{{good.id}}" class="cart-decrease" src="./image/fenlei_shanjian@2x.png"></image>
                            <view class="inner icon-remove_circle_outline"></view>
                        </view>
                        <text class="cart-count">{{good.number}}</text>
                        <image src="./image/fenlei_tianjia@2x.png" bindtap="addGoodToCartFn" id="add_{{good.id}}" class="cart-add icon-add_circle"></image>
                        
                    </view>  
                  </view>
              </view>
            </view>
          
        </view>
        </scroll-view>
      </view>
    </view>
  </view>
  
  <!--小球的实现-->


  <view class="good_box" hidden="{{hide_good_box}}"  style="left: {{bus_x}}px; top: {{bus_y}}px;">
  </view>


  
  <view style="height:86px;"></view>
  
</view>
<view bindtap="showShopCartFn" class="cover  {{(showShopCart && (totalPay > 0))?'':'hidden'}}"></view>

<view class='stock-mask' catchtouchmove='preventTouchMove' wx:if='{{showStock}}'>
  <view class='stock-box'>
    <view class='stock-box-title'>选购规格</view>
    <view class='stock-box-content'>
      <view class='stock-box-content-title'>规格:</view>
      <view class='stock-box-content-content'>
        <view class='stock-list' wx:for="{{stocks}}" wx:for-item="stock" id="stock_{{index}}_{{stock.id}}" class="{{(stockHighLightIndex == index) ? 'stock-list-active':'stock-list'}}" bindtap="choseStock">{{stock.stockName}}</view>

      </view>
    </view>
    <view class='stock-box-bottom'>
      <view class='stock-money'>￥2500</view>
      <view class='stock-btn' bindtap='choseStockYesBtn'>确认</view>
    </view>
  </view>
</view>  

<view class='mask' catchtouchmove='preventTouchMove' wx:if='{{showLoading}}'>
  <view class='loading'>努力加载中...</view>
</view>  